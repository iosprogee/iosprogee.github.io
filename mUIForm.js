var fb=firebase;fb.initializeApp({apiKey:"AIzaSyDMSdTQr8Y-FZWMgFMvb3tDyRf_y44KYis",authDomain:"fireupmyapp.firebaseapp.com",databaseURL:"https://fireupmyapp.firebaseio.com",projectId:"fireupmyapp",storageBucket:"fireupmyapp.appspot.com",messagingSenderId:"823746792317",appId:"1:823746792317:web:efbf29d7dc522a5a329a14",measurementId:"G-M08RXEKFFQ"});var d=document;d.title="CEF";var l=d.querySelector("link[rel*='icon']")||d.createElement("link");l.type="image/x-icon";l.rel="shortcut icon";l.href="https://iosprogee.github.io/favicon.ico";d.getElementsByTagName("head")[0].appendChild(l);d.querySelector('meta[name="apple-mobile-web-app-title"]').setAttribute("content",d.title);d.onkeypress=function(e){if(13==(e=e||window.event).keyCode){e.preventDefault();var a=Array.prototype.slice.call(document.querySelectorAll("input,textarea")),t=(a.indexOf(document.activeElement)+1)%a.length;a[t].focus()}};var aFields="id,name,email,phone,remarks".split(",");function clearInputs(e,a){aFields;a=a||"name";aFields.forEach((function(e){d.getElementById(e).value=""}));d.getElementById(a).focus()}var allLabels=d.getElementsByTagName("label");window.addEventListener("load",(function(){d.getElementsByTagName("input");Object.keys(allLabels).forEach((function(e){for(var a=allLabels[e].childNodes,t=0;t<a.length;t++)(a[t].nodeName="#text")&&(a[t].nodeValue="")}));d.getElementById("name").focus();d.getElementById("clear")&&d.getElementById("clear").addEventListener("click",(function(e){clearInputs()}));divList=d.getElementById("div-list");divForm=d.getElementById("div-form");d.getElementById("list").addEventListener("click",(function(e){if(divList.classList.contains("hide")){divList.classList.remove("hide");divForm.classList.add("hide");!function(e="customer"){!function(e){e.on("child_added",(function(e){!function(e,a){var t=document.createElement("div");t.innerHTML=function(e){return'<div class="id-'+e.key+' row list"><span class="cell"><h3 class="name">Robert</h3><span class="material-icons blue" type="x-small">phone</span><span class="phone" class="detail">9999 8888</span><span class="material-icons blue" type="x-small">email</span><span class="email" class="detail">r@robert.io</span></span><span class="cell vertical"><span class="material-icons blue medium right">keyboard_arrow_right</span></span></div>'}(e);var n=t.firstChild,i=e.val();aFields.forEach(a=>{if(i[a]){var t="";if("timeStamp"==a){var l=parseInt(i.timeStamp);t=new Date(l).toUTCString().substring(0,22)}else t=i[a];n.getElementsByClassName(a)[0]&&(n.getElementsByClassName(a)[0].innerText=t)}"id"==a&&n.getElementsByClassName(a)[0]&&(n.getElementsByClassName(a)[0].innerText=e.key)});a.insertBefore(n,a.firstSibling)}(e,container)}));e.on("child_changed",(function(e){console.log("child_changed")}));e.on("child_removed",(function(e){console.log("child_removed")}))}(firebase.database().ref(e+"/").orderByChild("name"))}()}else{divForm.classList.remove("hide");divList.classList.add("hide")}}));d.getElementById("save").addEventListener("click",(function(e){writeData2FB()}));d.getElementById("search").addEventListener("click",(function(e){d.getElementById("name").checkValidity()&&fb.database().ref("customer").orderByChild("name").equalTo(d.getElementById("name").value).once("value",(function(e){clearInputs();if(e.exists()){var a=Object.entries(e.val())[0];console.log(`key: ${a[0]}, name: ${a[1].name}`);aFields.forEach(e=>{d.getElementById(e).value="id"==e?a[0]:a[1][e]})}}));e.preventDefault()}));d.getElementById("submit").addEventListener("click",e=>{writeData2FB();e.preventDefault()})}),!1);var container=d.getElementById("div-list");function writeData2FB(e="customer",a=aFields){var t=d.getElementById("id").value||fb.database().ref(e).push().key;d.getElementById("id").value=t;fb.database().ref(e).orderByKey().equalTo(t).once("value",n=>{n.exists()?console.log(e+" existing.",n.val()):console.log(e+" new.");var i=a.reduce((e,a)=>Object.assign({},e,"id"!==a?{[a]:d.getElementById(a).value}:{}),{});fb.database().ref(e+"/"+t).update(i)})}
